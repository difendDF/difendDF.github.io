{
    "version": "https://jsonfeed.org/version/1",
    "title": "永恒绿洲",
    "subtitle": "虽然不容易，只要去做，就能成功",
    "icon": "https://sprenedayf.com/images/favicon.ico",
    "description": "努力学习、生活",
    "home_page_url": "https://sprenedayf.com",
    "items": [
        {
            "id": "https://sprenedayf.com/2022/04/15/Java/Zookeeper%E7%9A%84%E5%AE%89%E8%A3%85/",
            "url": "https://sprenedayf.com/2022/04/15/Java/Zookeeper%E7%9A%84%E5%AE%89%E8%A3%85/",
            "title": "Zookeeper的安装",
            "date_published": "2022-04-15T08:08:32.000Z",
            "content_html": "<h1 id=\"利用docker安装\"><a class=\"anchor\" href=\"#利用docker安装\">#</a> 利用 Docker 安装</h1>\n<p>本质上我是希望可以快速开始进行 Zookeeper 的相关实践，所以用 Docker 来帮我创建三个容器，利用 docker-compose 来帮我解决容器间的通信问题，<s>这样我就不用自己去配三个机器啦（误）</s></p>\n<h2 id=\"单节点\"><a class=\"anchor\" href=\"#单节点\">#</a> 单节点</h2>\n<ol>\n<li>创建一个文件夹用来将容器内的数据文件和本地文件夹绑定</li>\n</ol>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">mkdir</span> zookeeper <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">cd</span> zookeeper</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token function\">mkdir</span> data</pre></td></tr></table></figure><ol start=\"2\">\n<li>run 一个容器</li>\n</ol>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> run -d -e <span class=\"token assign-left variable\">TZ</span><span class=\"token operator\">=</span><span class=\"token string\">\"Asia/Shanghai\"</span> -p <span class=\"token number\">2181</span>:2181 -v <span class=\"token environment constant\">$PWD</span>/data:/data --name zookeeper --restart always zookeeper:3.7.0</pre></td></tr></table></figure><p>参数说明：</p>\n<pre><code>-e TZ=&quot;Asia/Shanghai&quot; # 指定上海时区 \n-d # 表示在一直在后台运行容器\n-p 2181:2181 # 对端口进行映射，将本地2181端口映射到容器内部的2181端口\n--name # 设置创建的容器名称\n-v # 将本地目录(文件)挂载到容器指定目录；\n--restart always #始终重新启动zookeeper\n</code></pre>\n<h2 id=\"集群\"><a class=\"anchor\" href=\"#集群\">#</a> 集群</h2>\n<p>单节点多没意思，单节点用 zookeeper 这不是<s>脱裤子放屁吗（bushi</s>！</p>\n<ol>\n<li>安装 docker-compose，这边建议利用 miniconda 来安装，上传一个安装包，bash 运行一下，然后 pip install 一下就成了</li>\n<li>写个 docker-compose.yml 文件</li>\n</ol>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">version</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'3.8'</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token key atrule\">services</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token key atrule\">zoo1</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> zookeeper<span class=\"token punctuation\">:</span>3.7.0</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> zoo1</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token key atrule\">hostname</span><span class=\"token punctuation\">:</span> zoo1</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token punctuation\">-</span> 2181<span class=\"token punctuation\">:</span><span class=\"token number\">2181</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token key atrule\">ZOO_MY_ID</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token key atrule\">ZOO_SERVERS</span><span class=\"token punctuation\">:</span> server.1=0.0.0.0<span class=\"token punctuation\">:</span>2888<span class=\"token punctuation\">:</span>3888;2181 server.2=zoo2<span class=\"token punctuation\">:</span>2888<span class=\"token punctuation\">:</span>3888;2181 server.3=zoo3<span class=\"token punctuation\">:</span>2888<span class=\"token punctuation\">:</span>3888;2181</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>  <span class=\"token key atrule\">zoo2</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> zookeeper<span class=\"token punctuation\">:</span>3.7.0</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> zoo2</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token key atrule\">hostname</span><span class=\"token punctuation\">:</span> zoo2</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token punctuation\">-</span> 2182<span class=\"token punctuation\">:</span><span class=\"token number\">2181</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token key atrule\">ZOO_MY_ID</span><span class=\"token punctuation\">:</span> <span class=\"token number\">2</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token key atrule\">ZOO_SERVERS</span><span class=\"token punctuation\">:</span> server.1=zoo1<span class=\"token punctuation\">:</span>2888<span class=\"token punctuation\">:</span>3888;2181 server.2=0.0.0.0<span class=\"token punctuation\">:</span>2888<span class=\"token punctuation\">:</span>3888;2181 server.3=zoo3<span class=\"token punctuation\">:</span>2888<span class=\"token punctuation\">:</span>3888;2181</pre></td></tr><tr><td data-num=\"23\"></td><td><pre></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>  <span class=\"token key atrule\">zoo3</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> zookeeper<span class=\"token punctuation\">:</span>3.7.0</pre></td></tr><tr><td data-num=\"26\"></td><td><pre>    <span class=\"token key atrule\">container_name</span><span class=\"token punctuation\">:</span> zoo3</pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token key atrule\">hostname</span><span class=\"token punctuation\">:</span> zoo3</pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token key atrule\">ports</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>      <span class=\"token punctuation\">-</span> 2183<span class=\"token punctuation\">:</span><span class=\"token number\">2181</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token key atrule\">environment</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>      <span class=\"token key atrule\">ZOO_MY_ID</span><span class=\"token punctuation\">:</span> <span class=\"token number\">3</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>      <span class=\"token key atrule\">ZOO_SERVERS</span><span class=\"token punctuation\">:</span> server.1=zoo1<span class=\"token punctuation\">:</span>2888<span class=\"token punctuation\">:</span>3888;2181 server.2=zoo2<span class=\"token punctuation\">:</span>2888<span class=\"token punctuation\">:</span>3888;2181 server.3=0.0.0.0<span class=\"token punctuation\">:</span>2888<span class=\"token punctuation\">:</span>3888;2181</pre></td></tr></table></figure><p>此配置文件表示，Docker 需要启动三个 zookeeper 实例，并将 2181，2182，2183 三个端口号映射到容器内的 2181 这个端口上。<br />\n <code>ZOO_MY_ID</code> ：表示 zk 服务的 ID, 取值为 1-255 之间的整数，且必须唯一<br />\n <code>ZOO_SERVERS</code> ：表示 zk 集群的主机列表</p>\n<ol start=\"3\">\n<li>启动集群</li>\n</ol>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker-compose</span> up -d</pre></td></tr></table></figure><p>这时候我们看一下我们的 docker 容器<br />\n<img data-src=\"https://s1.ax1x.com/2022/04/15/LGIvwT.png\" alt=\"LGIvwT.png\" /></p>\n<ol>\n<li>进去看看 zookeeper 状态</li>\n</ol>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> -it zoo1 /bin/sh</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>zkServer.sh status</pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> -it zoo2 /bin/sh</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>zkServer.sh status</pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token function\">docker</span> <span class=\"token builtin class-name\">exec</span> -it zoo3 /bin/sh</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>zkServer.sh status</pre></td></tr></table></figure><p>应该可以看到：<br />\n<img data-src=\"https://s1.ax1x.com/2022/04/15/LGokOx.png\" alt=\"LGokOx.png\" height=\"200px\" /></p>\n",
            "tags": [
                "Java",
                "中间件",
                "Zookeeper",
                "框架",
                "中间件",
                "Zookeeper"
            ]
        },
        {
            "id": "https://sprenedayf.com/2022/04/15/Java/Zookeeper%E7%9A%84%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%851/",
            "url": "https://sprenedayf.com/2022/04/15/Java/Zookeeper%E7%9A%84%E5%AD%A6%E4%B9%A0%E4%B9%8B%E6%97%851/",
            "title": "Zookeeper的学习之旅1",
            "date_published": "2022-04-15T07:36:37.000Z",
            "content_html": "<h1 id=\"zookeeper简介\"><a class=\"anchor\" href=\"#zookeeper简介\">#</a> Zookeeper 简介</h1>\n<h2 id=\"zookeeper是什么\"><a class=\"anchor\" href=\"#zookeeper是什么\">#</a> Zookeeper 是什么？</h2>\n<p>之前我对 Zookeeper 的了解仅限于在了解其他组件的时候总是会提到它，比如：在看 Nacos 注册中心的时候，就会提到 Zookeeper 也可以做注册中心；在看配置中心的时候，也有人提到 Zookeeper 可以做配置中心；在了解 Redis 的过程中，会有人说 Zookeeper 和 Redis 一样都可以实现分布式锁；甚至在我看 clickhouse 的时候，书中都跟我说 clickhouse 的集群是依赖于 zookeeper 的...... 好家伙，你这无处不在啊！那么 Zookeeper 到底是什么？</p>\n<p>Zookeeper 为分布式应用<strong>提供高效且可靠的分布式协调服务</strong>，主要用来解决分布式集群中应用系统的一致性问题，它提供了类似于文件系统的目录节点树方式的数据存储。但是 Zookeeper 并不是专门用来存储数据的，它的作用主要是用来<strong>维护和监控存储数据的状态变化。通过监控这些数据状态的变化，从而可以达到基于数据的集群管理。</strong></p>\n<h2 id=\"zookeeper能干什么\"><a class=\"anchor\" href=\"#zookeeper能干什么\">#</a> Zookeeper 能干什么</h2>\n<ul>\n<li>配置管理\n<ul>\n<li>集群节点可以通过中心源获取启动配置</li>\n<li>更简单的部署</li>\n</ul>\n</li>\n<li>分布式集群管理\n<ul>\n<li>节点加入 / 离开</li>\n<li>节点的实时状态</li>\n</ul>\n</li>\n<li>命名服务，如：DNS</li>\n<li>分布式同步：如锁、栅栏、队列</li>\n<li>分布式系统的选主</li>\n<li>中心化和高可靠的数据注册</li>\n</ul>\n<h2 id=\"需要注意的点\"><a class=\"anchor\" href=\"#需要注意的点\">#</a> 需要注意的点</h2>\n<ul>\n<li>Zookeeper 将<strong>数据全量存储在内存中</strong>，所以性能很高。由于 Zookeeper 的<strong>所有更新和删除操作都是基于事务的</strong>，因此 ZooKeeper 在读多写少的应用场景中有性能表现较好，如果写操作频繁，性能会大大下滑。</li>\n<li>对于来自客户端的每个更新请求，Zookeeper 都会分配一个全局唯一的递增 ID，这个 ID 反映了所有事务请求的先后顺序。</li>\n</ul>\n<h1 id=\"核心概念\"><a class=\"anchor\" href=\"#核心概念\">#</a> 核心概念</h1>\n",
            "tags": [
                "Java",
                "中间件",
                "Zookeeper",
                "框架",
                "中间件",
                "Zookeeper"
            ]
        },
        {
            "id": "https://sprenedayf.com/2022/04/14/Java/Spring-Boot-Druid-Mybatis%E9%85%8D%E7%BD%AE%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90/",
            "url": "https://sprenedayf.com/2022/04/14/Java/Spring-Boot-Druid-Mybatis%E9%85%8D%E7%BD%AE%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90/",
            "title": "Spring Boot+Druid+Mybatis配置多数据源",
            "date_published": "2022-04-14T07:33:12.000Z",
            "content_html": "<h1 id=\"背景\"><a class=\"anchor\" href=\"#背景\">#</a> 背景</h1>\n<p>项目现在有一个需求，需要从 mysql 中查询一些元数据，从 clickhouse 中查询一些聚合分析数据，所以需要在项目中配置两个数据源，本来是打算用 <code>JDBCTemplate</code>  来创建数据库连接解决，但是内心希望是可以利用连接池来帮助我解决这个需求，毕竟连接池可以帮我们管理连接，而且 clickhouse 也可以利用 Mybatis，正好不用把 sql 写到 java 代码里面了，统一放在 xml 文件里面更好管理。不多废话，直接开始：<br />\n本文采用的是 Druid 连接池，主要考虑到 Druid 自带了监控等功能，我们项目的查询上也没有极致的性能要求。</p>\n<h1 id=\"导入依赖\"><a class=\"anchor\" href=\"#导入依赖\">#</a> 导入依赖</h1>\n<figure class=\"highlight xml\"><figcaption data-lang=\"XML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">&lt;!-- clickhouse 连接 --></span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.clickhouse<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>clickhouse-jdbc<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>0.3.2-patch7<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token comment\">&lt;!-- druid 多数据源配置 --></span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>com.alibaba<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>druid<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>1.1.10<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre><span class=\"token comment\">&lt;!-- mysql 连接 --></span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>mysql<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>mysql-connector-java<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>8.0.16<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre><span class=\"token comment\">&lt;!-- mybatis 配置 --></span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>groupId</span><span class=\"token punctuation\">></span></span>org.mybatis.spring.boot<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>groupId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>artifactId</span><span class=\"token punctuation\">></span></span>mybatis-spring-boot-starter<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>artifactId</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>version</span><span class=\"token punctuation\">></span></span>2.1.0<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>version</span><span class=\"token punctuation\">></span></span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>dependency</span><span class=\"token punctuation\">></span></span></pre></td></tr></table></figure><h1 id=\"配置属性\"><a class=\"anchor\" href=\"#配置属性\">#</a> 配置属性</h1>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">spring</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">datasource</span><span class=\"token punctuation\">:</span>  </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token key atrule\">type</span><span class=\"token punctuation\">:</span> com.alibaba.druid.pool.DruidDataSource</pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token key atrule\">druid</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>      <span class=\"token comment\">#最大活跃数</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token key atrule\">maxActive</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token comment\">#初始化数量</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>      <span class=\"token key atrule\">initialSize</span><span class=\"token punctuation\">:</span> <span class=\"token number\">1</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>      <span class=\"token comment\">#最大连接等待超时时间</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>      <span class=\"token key atrule\">maxWait</span><span class=\"token punctuation\">:</span> <span class=\"token number\">120000</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>      <span class=\"token key atrule\">validation-query</span><span class=\"token punctuation\">:</span> select 1;</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>      <span class=\"token key atrule\">filter</span><span class=\"token punctuation\">:</span> stat<span class=\"token punctuation\">,</span>wall</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>    <span class=\"token key atrule\">mysql</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>      <span class=\"token key atrule\">jdbc-url</span><span class=\"token punctuation\">:</span> jdbc<span class=\"token punctuation\">:</span>mysql<span class=\"token punctuation\">:</span>//你的mysql地址<span class=\"token punctuation\">:</span>3306/数据库<span class=\"token punctuation\">?</span>characterEncoding=utf8<span class=\"token important\">&amp;zeroDateTimeBehavior=convertToNull&amp;useSSL=false&amp;useJDBCCompliantTimezoneShift=true&amp;useLegacyDatetimeCode=false&amp;serverTimezone=Asia/Shanghai</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>      <span class=\"token key atrule\">driver-class-name</span><span class=\"token punctuation\">:</span> com.mysql.cj.jdbc.Driver</pre></td></tr><tr><td data-num=\"16\"></td><td><pre>      <span class=\"token key atrule\">username</span><span class=\"token punctuation\">:</span> root</pre></td></tr><tr><td data-num=\"17\"></td><td><pre>      <span class=\"token key atrule\">password</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 你的连接密码</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>    <span class=\"token key atrule\">clickhouse</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>      <span class=\"token key atrule\">driver-class-name</span><span class=\"token punctuation\">:</span> com.clickhouse.jdbc.ClickHouseDriver</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>      <span class=\"token key atrule\">jdbc-url</span><span class=\"token punctuation\">:</span> jdbc<span class=\"token punctuation\">:</span>clickhouse<span class=\"token punctuation\">:</span>//你的clickhouse地址<span class=\"token punctuation\">:</span><span class=\"token number\">8123</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre>      <span class=\"token key atrule\">username</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 连接名 默认为 default</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>      <span class=\"token key atrule\">password</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 你的连接密码</span></pre></td></tr></table></figure><p>与此同时为了能够在控制台打印出我们查询的语句，所以我们可以把 sql 打印出来，还是在你的 yml 文件中配置:</p>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">logging</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">level</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>    <span class=\"token key atrule\">com.pig4cloud.pig.tagchbi.dao</span><span class=\"token punctuation\">:</span> debug</pre></td></tr></table></figure><h1 id=\"编写配置类\"><a class=\"anchor\" href=\"#编写配置类\">#</a> 编写配置类</h1>\n<p>这里你有几个数据源就要写几个配置类，比如我项目中有 mysql 和 clickhouse 两个数据源，所以我就写了 <code>MysqlConfig</code>  和 <code>ClickhouseConfig</code>  两个配置类。</p>\n<figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\">// MysqlConfig</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"4\"></td><td><pre> * @author difendDF</pre></td></tr><tr><td data-num=\"5\"></td><td><pre> * @date 2022/04/05 10:47 上午</pre></td></tr><tr><td data-num=\"6\"></td><td><pre> */</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre><span class=\"token annotation punctuation\">@Configuration</span>    <span class=\"token comment\">// 注册到容器中</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre><span class=\"token comment\">// 这里配置你的 DAO 文件的位置</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token annotation punctuation\">@MapperScan</span><span class=\"token punctuation\">(</span>basePackages <span class=\"token operator\">=</span> <span class=\"token string\">\"com.pig4cloud.pig.tagchbi.dao.clickhouse\"</span><span class=\"token punctuation\">,</span>sqlSessionTemplateRef <span class=\"token operator\">=</span> <span class=\"token string\">\"ClickhouseSessionTemplate\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">ClickhouseConfig</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>     * 配置多数据源 关键就在这里 这里配置了不同的数据源扫描不同 mapper</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token comment\">// 这里配置你的 mapper.xml 文件的位置</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> MAPPER_LOCATION <span class=\"token operator\">=</span> <span class=\"token string\">\"classpath:mapper/clickhouse/*.xml\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>     * @desc: sqlSession 配置</pre></td></tr><tr><td data-num=\"19\"></td><td><pre>     * @param: []</pre></td></tr><tr><td data-num=\"20\"></td><td><pre>     * @return: org.apache.ibatis.session.Configuration</pre></td></tr><tr><td data-num=\"21\"></td><td><pre>     **/</span></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"configurationClickhouse\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>ibatis<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span></span>Configuration</span> <span class=\"token function\">configurationClickhouse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>        <span class=\"token class-name\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>ibatis<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span></span>Configuration</span> configuration <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>ibatis<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span></span>Configuration</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>        <span class=\"token comment\">// 开启驼峰映射</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        configuration<span class=\"token punctuation\">.</span><span class=\"token function\">setMapUnderscoreToCamelCase</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>        <span class=\"token keyword\">return</span> configuration<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"29\"></td><td><pre></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"clickhouseDataSource\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token annotation punctuation\">@ConfigurationProperties</span><span class=\"token punctuation\">(</span>prefix <span class=\"token operator\">=</span> <span class=\"token string\">\"spring.datasource.clickhouse\"</span><span class=\"token punctuation\">)</span><span class=\"token comment\">// 设置配置</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">DataSource</span> <span class=\"token function\">clickhouseDataSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token class-name\">DataSourceBuilder</span><span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"clickhouseSessionFactory\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SqlSessionFactory</span> <span class=\"token function\">clickhouseSessionFactory</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Qualifier</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"clickhouseDataSource\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">DataSource</span> dataSource<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>        <span class=\"token class-name\">SqlSessionFactoryBean</span> bean <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlSessionFactoryBean</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre>        bean<span class=\"token punctuation\">.</span><span class=\"token function\">setDataSource</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>        bean<span class=\"token punctuation\">.</span><span class=\"token function\">setConfiguration</span><span class=\"token punctuation\">(</span><span class=\"token function\">configurationClickhouse</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>        bean<span class=\"token punctuation\">.</span><span class=\"token function\">setTypeAliasesPackage</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"com.pig4cloud.pig.tagchbi.dao.clickhouse\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>        bean<span class=\"token punctuation\">.</span><span class=\"token function\">setMapperLocations</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">PathMatchingResourcePatternResolver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getResources</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">ClickhouseConfig</span><span class=\"token punctuation\">.</span>MAPPER_LOCATION<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token keyword\">return</span> bean<span class=\"token punctuation\">.</span><span class=\"token function\">getObject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"clickhouseTransactionManager\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">DataSourceTransactionManager</span> <span class=\"token function\">clickhouseTransactionManager</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Qualifier</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"clickhouseDataSource\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">DataSource</span> dataSource<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DataSourceTransactionManager</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre></pre></td></tr><tr><td data-num=\"51\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"ClickhouseSessionTemplate\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SqlSessionTemplate</span> <span class=\"token function\">clickhouseSqlSessionTemplate</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Qualifier</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"clickhouseSessionFactory\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">SqlSessionFactory</span> sqlSessionFactory<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"53\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlSessionTemplate</span><span class=\"token punctuation\">(</span>sqlSessionFactory<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"54\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"55\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><figure class=\"highlight java\"><figcaption data-lang=\"java\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token annotation punctuation\">@Configuration</span>    <span class=\"token comment\">// 注册到容器中</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token annotation punctuation\">@MapperScan</span><span class=\"token punctuation\">(</span>basePackages <span class=\"token operator\">=</span> <span class=\"token string\">\"com.pig4cloud.pig.tagchbi.dao.mysql\"</span><span class=\"token punctuation\">,</span>sqlSessionTemplateRef <span class=\"token operator\">=</span> <span class=\"token string\">\"MysqlSessionTemplate\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">MysqlConfig</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>     * 配置多数据源 关键就在这里 这里配置了不同的数据源扫描不同 mapper</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>     */</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>    <span class=\"token keyword\">static</span> <span class=\"token keyword\">final</span> <span class=\"token class-name\">String</span> MAPPER_LOCATION <span class=\"token operator\">=</span> <span class=\"token string\">\"classpath:mapper/mysql/*.xml\"</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>     * @desc: sqlSession 配置</pre></td></tr><tr><td data-num=\"11\"></td><td><pre>     * @param: []</pre></td></tr><tr><td data-num=\"12\"></td><td><pre>     * @return: org.apache.ibatis.session.Configuration</pre></td></tr><tr><td data-num=\"13\"></td><td><pre>     **/</span></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"configurationMysql\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"15\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>ibatis<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span></span>Configuration</span> <span class=\"token function\">configurationMysql</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>        <span class=\"token class-name\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>ibatis<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span></span>Configuration</span> configuration <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\"><span class=\"token namespace\">org<span class=\"token punctuation\">.</span>apache<span class=\"token punctuation\">.</span>ibatis<span class=\"token punctuation\">.</span>session<span class=\"token punctuation\">.</span></span>Configuration</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre>        <span class=\"token comment\">// 开启驼峰映射</span></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>        configuration<span class=\"token punctuation\">.</span><span class=\"token function\">setMapUnderscoreToCamelCase</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>        <span class=\"token keyword\">return</span> configuration<span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"21\"></td><td><pre></pre></td></tr><tr><td data-num=\"22\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"MysqlDataSource\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"23\"></td><td><pre>    <span class=\"token annotation punctuation\">@Primary</span></pre></td></tr><tr><td data-num=\"24\"></td><td><pre>    <span class=\"token annotation punctuation\">@ConfigurationProperties</span><span class=\"token punctuation\">(</span>prefix <span class=\"token operator\">=</span> <span class=\"token string\">\"spring.datasource.mysql\"</span><span class=\"token punctuation\">)</span><span class=\"token comment\">// 设置配置</span></pre></td></tr><tr><td data-num=\"25\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">DataSource</span> <span class=\"token function\">mysqlDataSource</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"26\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token class-name\">DataSourceBuilder</span><span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">build</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"27\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"28\"></td><td><pre></pre></td></tr><tr><td data-num=\"29\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"MysqlSessionFactory\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"30\"></td><td><pre>    <span class=\"token annotation punctuation\">@Primary</span></pre></td></tr><tr><td data-num=\"31\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SqlSessionFactory</span> <span class=\"token function\">mysqlSessionFactory</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Qualifier</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MysqlDataSource\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">DataSource</span> dataSource<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"32\"></td><td><pre>        <span class=\"token class-name\">SqlSessionFactoryBean</span> bean <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlSessionFactoryBean</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"33\"></td><td><pre>        bean<span class=\"token punctuation\">.</span><span class=\"token function\">setDataSource</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"34\"></td><td><pre>        bean<span class=\"token punctuation\">.</span><span class=\"token function\">setConfiguration</span><span class=\"token punctuation\">(</span><span class=\"token function\">configurationMysql</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"35\"></td><td><pre>        bean<span class=\"token punctuation\">.</span><span class=\"token function\">setTypeAliasesPackage</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"com.pig4cloud.pig.tagchbi.dao.mysql\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"36\"></td><td><pre>        bean<span class=\"token punctuation\">.</span><span class=\"token function\">setMapperLocations</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">PathMatchingResourcePatternResolver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getResources</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">MysqlConfig</span><span class=\"token punctuation\">.</span>MAPPER_LOCATION<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"37\"></td><td><pre>        <span class=\"token keyword\">return</span> bean<span class=\"token punctuation\">.</span><span class=\"token function\">getObject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"38\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"39\"></td><td><pre></pre></td></tr><tr><td data-num=\"40\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"MysqlTransactionManager\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"41\"></td><td><pre>    <span class=\"token annotation punctuation\">@Primary</span></pre></td></tr><tr><td data-num=\"42\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">DataSourceTransactionManager</span> <span class=\"token function\">mysqlTransactionManager</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Qualifier</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MysqlDataSource\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">DataSource</span> dataSource<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"43\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DataSourceTransactionManager</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"44\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"45\"></td><td><pre></pre></td></tr><tr><td data-num=\"46\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"MysqlSessionTemplate\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"47\"></td><td><pre>    <span class=\"token annotation punctuation\">@Primary</span></pre></td></tr><tr><td data-num=\"48\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">SqlSessionTemplate</span> <span class=\"token function\">mysqlSqlSessionTemplate</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Qualifier</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MysqlSessionFactory\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">SqlSessionFactory</span> sqlSessionFactory<span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"49\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">SqlSessionTemplate</span><span class=\"token punctuation\">(</span>sqlSessionFactory<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"50\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"51\"></td><td><pre></pre></td></tr><tr><td data-num=\"52\"></td><td><pre>    <span class=\"token comment\">/**</pre></td></tr><tr><td data-num=\"53\"></td><td><pre>     * @desc: 数据源 1 的事务管理</pre></td></tr><tr><td data-num=\"54\"></td><td><pre>     * @param: [dataSource]</pre></td></tr><tr><td data-num=\"55\"></td><td><pre>     * @return: org.springframework.jdbc.datasource.DataSourceTransactionManager</pre></td></tr><tr><td data-num=\"56\"></td><td><pre>     **/</span></pre></td></tr><tr><td data-num=\"57\"></td><td><pre>    <span class=\"token annotation punctuation\">@Bean</span><span class=\"token punctuation\">(</span>name <span class=\"token operator\">=</span> <span class=\"token string\">\"dataSourceTransactionManagerMysql\"</span><span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"58\"></td><td><pre>    <span class=\"token annotation punctuation\">@Primary</span></pre></td></tr><tr><td data-num=\"59\"></td><td><pre>    <span class=\"token keyword\">public</span> <span class=\"token class-name\">DataSourceTransactionManager</span> <span class=\"token function\">dataSourceTransactionManagerMysql</span><span class=\"token punctuation\">(</span><span class=\"token annotation punctuation\">@Qualifier</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"MysqlDataSource\"</span><span class=\"token punctuation\">)</span> <span class=\"token class-name\">DataSource</span> dataSource<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">&#123;</span></pre></td></tr><tr><td data-num=\"60\"></td><td><pre>        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DataSourceTransactionManager</span><span class=\"token punctuation\">(</span>dataSource<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></pre></td></tr><tr><td data-num=\"61\"></td><td><pre>    <span class=\"token punctuation\">&#125;</span></pre></td></tr><tr><td data-num=\"62\"></td><td><pre><span class=\"token punctuation\">&#125;</span></pre></td></tr></table></figure><p>项目路径如图所示<br />\n<img data-src=\"https://s1.ax1x.com/2022/04/14/LlbXqK.png\" alt=\"LlbXqK.png\" title=\"项目结构\" height=\"300px\" /></p>\n<h1 id=\"使用\"><a class=\"anchor\" href=\"#使用\">#</a> 使用</h1>\n<p>在需要使用的位置，直接 Autowired 你写的 DAO 接口，然后在相应的 xml 文件中写 sql 语句就可以正常使用了。</p>\n<h1 id=\"小tips\"><a class=\"anchor\" href=\"#小tips\">#</a> 小 Tips</h1>\n<ol>\n<li>因为我在配置多数据源前已经用 Mybatis 操作了 mysql 数据库，在配置了多数据源之后发现表和实体之间的映射出现了问题，判断是驼峰命名出现了问题，这时候我在 yml 配置文件中加入 <code>type-aliases-package: com.pig4cloud.pig.tagchbi.dao\t#使用驼峰注解映射</code> 是无效的。这是因为你项目中有多个数据源，而 mybatis 不知道你这个配置要给哪个数据源用，所以我就在每个数据源的配置文件中单独加了一行代码 <code>configuration.setMapUnderscoreToCamelCase(true);</code>  来保证驼峰命名开启</li>\n<li>虽然考虑到 Druid 的监控，但是现在项目中暂时没有开启，如果要开启，可以在 yml 配置文件中写入</li>\n</ol>\n<figure class=\"highlight yml\"><figcaption data-lang=\"YAML\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token key atrule\">druid</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>  <span class=\"token key atrule\">min-idle</span><span class=\"token punctuation\">:</span> <span class=\"token number\">0</span> <span class=\"token comment\"># 池中维护的最小空闲连接数，默认为 0 个。</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>  <span class=\"token key atrule\">max-active</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span> <span class=\"token comment\"># 池中最大连接数，包括闲置和使用中的连接，默认为 8 个。</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>  <span class=\"token key atrule\">filter</span><span class=\"token punctuation\">:</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre>    <span class=\"token key atrule\">stat</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 配置 StatFilter ，对应文档 https://github.com/alibaba/druid/wiki/% E9%85%8D% E7% BD% AE_StatFilter</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>      <span class=\"token key atrule\">log-slow-sql</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span> <span class=\"token comment\"># 开启慢查询记录</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>      <span class=\"token key atrule\">slow-sql-millis</span><span class=\"token punctuation\">:</span> <span class=\"token number\">5000</span> <span class=\"token comment\"># 慢 SQL 的标准，单位：毫秒</span></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>  <span class=\"token key atrule\">stat-view-servlet</span><span class=\"token punctuation\">:</span> <span class=\"token comment\"># 配置 StatViewServlet ，对应文档 https://github.com/alibaba/druid/wiki/% E9%85%8D% E7% BD% AE_StatViewServlet% E9%85%8D% E7% BD% AE</span></pre></td></tr><tr><td data-num=\"9\"></td><td><pre>    <span class=\"token key atrule\">enabled</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span> <span class=\"token comment\"># 是否开启 StatViewServlet</span></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>    <span class=\"token key atrule\">login-username</span><span class=\"token punctuation\">:</span> sprenedayf <span class=\"token comment\"># 账号</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>    <span class=\"token key atrule\">login-password</span><span class=\"token punctuation\">:</span> theonly <span class=\"token comment\"># 密码</span></pre></td></tr></table></figure><p>然后就可以通过 <code>localhost:8080/druid</code>  来访问到监控页面</p>\n",
            "tags": [
                "Java",
                "框架",
                "Spring Boot",
                "框架"
            ]
        },
        {
            "id": "https://sprenedayf.com/2022/04/11/big-data/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%8D%A0%E4%BD%8D%E6%96%87%E4%BB%B6/",
            "url": "https://sprenedayf.com/2022/04/11/big-data/%E5%A4%A7%E6%95%B0%E6%8D%AE%E5%8D%A0%E4%BD%8D%E6%96%87%E4%BB%B6/",
            "title": "大数据占位文件",
            "date_published": "2022-04-11T07:57:48.000Z",
            "content_html": "<h1 id=\"大数据占位文件\"><a class=\"anchor\" href=\"#大数据占位文件\">#</a> 大数据占位文件</h1>\n<p>这是一个大数据占位文件</p>\n",
            "tags": [
                "大数据",
                "大数据"
            ]
        },
        {
            "id": "https://sprenedayf.com/2022/04/11/Java/Java/",
            "url": "https://sprenedayf.com/2022/04/11/Java/Java/",
            "title": "Java占位文件",
            "date_published": "2022-04-11T07:53:43.000Z",
            "content_html": "<h1 id=\"java占位文件\"><a class=\"anchor\" href=\"#java占位文件\">#</a> Java 占位文件</h1>\n<p>这是一个 Java 占位文件</p>\n",
            "tags": [
                "Java",
                "Java"
            ]
        },
        {
            "id": "https://sprenedayf.com/2022/04/10/computer-science/linux%E5%AD%A6%E4%B9%A01/",
            "url": "https://sprenedayf.com/2022/04/10/computer-science/linux%E5%AD%A6%E4%B9%A01/",
            "title": "linux学习1",
            "date_published": "2022-04-10T09:55:31.000Z",
            "content_html": "<h1 id=\"linux学习\"><a class=\"anchor\" href=\"#linux学习\">#</a> linux 学习</h1>\n<blockquote>\n<p><span class=\"exturl\" data-url=\"aHR0cHM6Ly93d3cuY25ibG9ncy5jb20vZG9uZ3llOTUvcC8xMjQzNDQ0OC5odG1s\">Linux 实战 100 讲</span></p>\n</blockquote>\n<h2 id=\"文件基本属性\"><a class=\"anchor\" href=\"#文件基本属性\">#</a> 文件基本属性</h2>\n<p>在 Linux 中第一个字符代表这个文件是目录、文件或链接文件等等。</p>\n<ul>\n<li>当为 <strong>d</strong> 则是目录</li>\n<li>当为 <strong>-</strong> 则是文件；</li>\n<li>若是 <strong>l</strong> 则表示为链接文档 (link file)；</li>\n<li>若是 <strong>b</strong> 则表示为装置文件里面的可供储存的接口设备 (可随机存取装置)；</li>\n<li>若是 <strong>c</strong> 则表示为装置文件里面的串行端口设备，例如键盘、鼠标 (一次性读取装置)。</li>\n</ul>\n<p><img data-src=\"https://s1.ax1x.com/2022/04/10/LA4UhR.png\" alt=\"LA4UhR.png\" /></p>\n<p>文件的权限字符为： <strong>-rwxrwxrwx</strong> ， 这九个权限是三个三个一组的！其中，我们可以使用数字来代表各个权限，各权限的分数对照表如下：</p>\n<ul>\n<li>r:4</li>\n<li>w:2</li>\n<li>x:1</li>\n</ul>\n<p>每种身份 (owner/group/others) 各自的三个权限 (r/w/x) 分数是需要累加的，例如当权限为： <strong>-rwxrwx---</strong> 分数则是：</p>\n<ul>\n<li>owner = rwx = 4+2+1 = 7</li>\n<li>group = rwx = 4+2+1 = 7</li>\n<li>others= --- = 0+0+0 = 0</li>\n</ul>\n<h2 id=\"处理目录有关命令\"><a class=\"anchor\" href=\"#处理目录有关命令\">#</a> 处理目录有关命令</h2>\n<ul>\n<li>ls（英文全拼：list files）: 列出目录及文件名</li>\n<li>cd（英文全拼：change directory）：切换目录</li>\n<li>pwd（英文全拼：print work directory）：显示目前的目录</li>\n<li>mkdir（英文全拼：make directory）：创建一个新的目录</li>\n<li>rmdir（英文全拼：remove directory）：删除一个空的目录</li>\n<li>cp（英文全拼：copy file）: 复制文件或目录</li>\n<li>rm（英文全拼：remove）: 删除文件或目录</li>\n<li>mv（英文全拼：move file）: 移动文件与目录，或修改文件与目录的名称</li>\n</ul>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@difend:~/test<span class=\"token comment\"># mkdir test1/test2/test3</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>mkdir: cannot create directory ‘test1/test2/test3’: No such <span class=\"token function\">file</span> or directory</pre></td></tr><tr><td data-num=\"3\"></td><td><pre>root@difend:~/test<span class=\"token comment\"># mkdir mkdir -p test1/test2/test3</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>root@difend:~/test<span class=\"token comment\"># tree</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre><span class=\"token builtin class-name\">.</span></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>├── <span class=\"token function\">mkdir</span></pre></td></tr><tr><td data-num=\"7\"></td><td><pre>└── test1</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>    └── test2</pre></td></tr><tr><td data-num=\"9\"></td><td><pre>        └── test3</pre></td></tr><tr><td data-num=\"10\"></td><td><pre></pre></td></tr><tr><td data-num=\"11\"></td><td><pre><span class=\"token number\">4</span> directories, <span class=\"token number\">0</span> files</pre></td></tr></table></figure><figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>root@difend:~/test<span class=\"token comment\"># mkdir -m 711 testm</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>root@difend:~/test<span class=\"token comment\"># ll</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre>total <span class=\"token number\">20</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>drwxr-xr-x <span class=\"token number\">5</span> root root <span class=\"token number\">4096</span> Sep <span class=\"token number\">17</span> <span class=\"token number\">14</span>:15 ./</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>drwx------ <span class=\"token number\">6</span> root root <span class=\"token number\">4096</span> Sep <span class=\"token number\">17</span> <span class=\"token number\">14</span>:13 <span class=\"token punctuation\">..</span>/</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>drwxr-xr-x <span class=\"token number\">2</span> root root <span class=\"token number\">4096</span> Sep <span class=\"token number\">17</span> <span class=\"token number\">14</span>:14 mkdir/</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>drwxr-xr-x <span class=\"token number\">3</span> root root <span class=\"token number\">4096</span> Sep <span class=\"token number\">17</span> <span class=\"token number\">14</span>:14 test1/</pre></td></tr><tr><td data-num=\"8\"></td><td><pre>drwx--x--x <span class=\"token number\">2</span> root root <span class=\"token number\">4096</span> Sep <span class=\"token number\">17</span> <span class=\"token number\">14</span>:15 testm/</pre></td></tr></table></figure><figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># rmdir: 删除空的目录</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>root@difend:~/test<span class=\"token comment\"># tree</span></pre></td></tr><tr><td data-num=\"3\"></td><td><pre><span class=\"token builtin class-name\">.</span></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>├── test1</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>│   └── test2</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>│       └── test3</pre></td></tr><tr><td data-num=\"7\"></td><td><pre>└── testm</pre></td></tr><tr><td data-num=\"8\"></td><td><pre></pre></td></tr><tr><td data-num=\"9\"></td><td><pre><span class=\"token number\">4</span> directories, <span class=\"token number\">0</span> files</pre></td></tr><tr><td data-num=\"10\"></td><td><pre>root@difend:~/test<span class=\"token comment\"># rmdir testm</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre>root@difend:~/test<span class=\"token comment\"># tree</span></pre></td></tr><tr><td data-num=\"12\"></td><td><pre><span class=\"token builtin class-name\">.</span></pre></td></tr><tr><td data-num=\"13\"></td><td><pre>└── test1</pre></td></tr><tr><td data-num=\"14\"></td><td><pre>    └── test2</pre></td></tr><tr><td data-num=\"15\"></td><td><pre>        └── test3</pre></td></tr><tr><td data-num=\"16\"></td><td><pre></pre></td></tr><tr><td data-num=\"17\"></td><td><pre><span class=\"token number\">3</span> directories, <span class=\"token number\">0</span> files</pre></td></tr><tr><td data-num=\"18\"></td><td><pre>root@difend:~/test<span class=\"token comment\"># rmdir test1</span></pre></td></tr><tr><td data-num=\"19\"></td><td><pre>rmdir: failed to remove <span class=\"token string\">'test1'</span><span class=\"token builtin class-name\">:</span> Directory not empty</pre></td></tr></table></figure><figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># cp [-adfilprsu] 来源档 (source) 目标档 (destination)</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>选项与参数：</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>-a：相当於 -pdr 的意思，至於 pdr 请参考下列说明；<span class=\"token punctuation\">(</span>常用<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"5\"></td><td><pre></pre></td></tr><tr><td data-num=\"6\"></td><td><pre>-d：若来源档为连结档的属性<span class=\"token punctuation\">(</span>link <span class=\"token function\">file</span><span class=\"token punctuation\">)</span>，则复制连结档属性而非文件本身；</pre></td></tr><tr><td data-num=\"7\"></td><td><pre></pre></td></tr><tr><td data-num=\"8\"></td><td><pre>-f：为强制<span class=\"token punctuation\">(</span>force<span class=\"token punctuation\">)</span>的意思，若目标文件已经存在且无法开启，则移除后再尝试一次；</pre></td></tr><tr><td data-num=\"9\"></td><td><pre></pre></td></tr><tr><td data-num=\"10\"></td><td><pre>-i：若目标档<span class=\"token punctuation\">(</span>destination<span class=\"token punctuation\">)</span>已经存在时，在覆盖时会先询问动作的进行<span class=\"token punctuation\">(</span>常用<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"11\"></td><td><pre></pre></td></tr><tr><td data-num=\"12\"></td><td><pre>-l：进行硬式连结<span class=\"token punctuation\">(</span>hard <span class=\"token function\">link</span><span class=\"token punctuation\">)</span>的连结档创建，而非复制文件本身；</pre></td></tr><tr><td data-num=\"13\"></td><td><pre></pre></td></tr><tr><td data-num=\"14\"></td><td><pre>-p：连同文件的属性一起复制过去，而非使用默认属性<span class=\"token punctuation\">(</span>备份常用<span class=\"token punctuation\">)</span>；</pre></td></tr><tr><td data-num=\"15\"></td><td><pre></pre></td></tr><tr><td data-num=\"16\"></td><td><pre>-r：递归持续复制，用於目录的复制行为；<span class=\"token punctuation\">(</span>常用<span class=\"token punctuation\">)</span></pre></td></tr><tr><td data-num=\"17\"></td><td><pre></pre></td></tr><tr><td data-num=\"18\"></td><td><pre>-s：复制成为符号连结档 <span class=\"token punctuation\">(</span>symbolic <span class=\"token function\">link</span><span class=\"token punctuation\">)</span>，亦即『捷径』文件；</pre></td></tr><tr><td data-num=\"19\"></td><td><pre></pre></td></tr><tr><td data-num=\"20\"></td><td><pre>-u：若 destination 比 <span class=\"token builtin class-name\">source</span> 旧才升级 destination ！</pre></td></tr></table></figure><figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># rm [-fir] 文件或目录</span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre> 选项与参数：</pre></td></tr><tr><td data-num=\"3\"></td><td><pre></pre></td></tr><tr><td data-num=\"4\"></td><td><pre>-f ：就是 force 的意思，忽略不存在的文件，不会出现警告信息；</pre></td></tr><tr><td data-num=\"5\"></td><td><pre>-i ：互动模式，在删除前会询问使用者是否动作</pre></td></tr><tr><td data-num=\"6\"></td><td><pre>-r ：递归删除</pre></td></tr></table></figure><h2 id=\"linux文件内容查看\"><a class=\"anchor\" href=\"#linux文件内容查看\">#</a> Linux 文件内容查看</h2>\n<p>Linux 系统中使用以下命令来查看文件的内容：</p>\n<ul>\n<li>cat 由第一行开始显示文件内容</li>\n<li>tac 从最后一行开始显示，可以看出 tac 是 cat 的倒着写！</li>\n<li>nl  显示的时候，顺道输出行号！</li>\n<li>more 一页一页的显示文件内容</li>\n<li>less 与 more 类似，但是比 more 更好的是，他可以往前翻页！</li>\n<li>head 只看头几行</li>\n<li>tail 只看尾巴几行</li>\n</ul>\n<h2 id=\"用户和用户组管理\"><a class=\"anchor\" href=\"#用户和用户组管理\">#</a> 用户和用户组管理</h2>\n<h3 id=\"添加新用户\"><a class=\"anchor\" href=\"#添加新用户\">#</a> 添加新用户</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">useradd</span> 选项 用户名</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># useradd –d  /home/sam -m sam</span></pre></td></tr></table></figure><p>参数说明：</p>\n<ul>\n<li>\n<p>选项:</p>\n<ul>\n<li>-c comment 指定一段注释性描述。</li>\n<li>-d 目录 指定用户主目录，如果此目录不存在，则同时使用 - m 选项，可以创建主目录。</li>\n<li>-g 用户组 指定用户所属的用户组。</li>\n<li>-G 用户组，用户组 指定用户所属的附加组。</li>\n<li>-s Shell 文件 指定用户的登录 Shell。</li>\n<li>-u 用户号 指定用户的用户号，如果同时有 - o 选项，则可以重复使用其他用户的标识号。</li>\n</ul>\n</li>\n<li>\n<p>用户名:</p>\n<p>指定新账号的登录名。</p>\n</li>\n</ul>\n<h3 id=\"删除账号\"><a class=\"anchor\" href=\"#删除账号\">#</a> 删除账号</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">userdel</span> 选项 用户名</pre></td></tr><tr><td data-num=\"2\"></td><td><pre><span class=\"token comment\"># userdel -r sam</span></pre></td></tr></table></figure><h3 id=\"修改账号\"><a class=\"anchor\" href=\"#修改账号\">#</a> 修改账号</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">usermod</span> 选项 用户名</pre></td></tr></table></figure><h3 id=\"用户口令\"><a class=\"anchor\" href=\"#用户口令\">#</a> 用户口令</h3>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">passwd</span> 选项 用户名</pre></td></tr></table></figure><p>用户修改自己的口令</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>$ <span class=\"token function\">passwd</span> </pre></td></tr><tr><td data-num=\"2\"></td><td><pre>Old password:****** </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>New password:******* </pre></td></tr><tr><td data-num=\"4\"></td><td><pre>Re-enter new password:*******</pre></td></tr></table></figure><p>超级用户修改某个用户的口令</p>\n<figure class=\"highlight shell\"><figcaption data-lang=\"Bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token comment\"># passwd sam </span></pre></td></tr><tr><td data-num=\"2\"></td><td><pre>New password:******* </pre></td></tr><tr><td data-num=\"3\"></td><td><pre>Re-enter new password:*******</pre></td></tr></table></figure><h2 id=\"常用命令\"><a class=\"anchor\" href=\"#常用命令\">#</a> 常用命令</h2>\n<h3 id=\"给用户分配使用权限\"><a class=\"anchor\" href=\"#给用户分配使用权限\">#</a> 给用户分配使用权限</h3>\n<p>1. 查看某应用的用户组</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre><span class=\"token function\">cat</span> /etc/group <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> 应用名称</pre></td></tr></table></figure><p>2. 将用户添加到对应的用户组</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>addgroup 用户名 应用组名</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>eg:addgroup wxm <span class=\"token function\">docker</span></pre></td></tr></table></figure><p>3. 更新用户组</p>\n<figure class=\"highlight bash\"><figcaption data-lang=\"bash\"></figcaption><table><tr><td data-num=\"1\"></td><td><pre>newgrp 应用组名</pre></td></tr><tr><td data-num=\"2\"></td><td><pre>eg: newgrp <span class=\"token function\">docker</span></pre></td></tr></table></figure>",
            "tags": [
                "计算机基础",
                "Linux",
                "Linux"
            ]
        },
        {
            "id": "https://sprenedayf.com/2022/04/10/life/%E6%88%91%E8%AF%95%E8%AF%95/",
            "url": "https://sprenedayf.com/2022/04/10/life/%E6%88%91%E8%AF%95%E8%AF%95/",
            "title": "我试试",
            "date_published": "2022-04-10T03:11:20.000Z",
            "content_html": "<h2 id=\"测试一下呢\"><a class=\"anchor\" href=\"#测试一下呢\">#</a> 测试一下呢</h2>\n<p>四间房 ISO 放假色</p>\n",
            "tags": [
                "生活杂谈"
            ]
        }
    ]
}